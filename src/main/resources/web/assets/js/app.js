// Generated by CoffeeScript 1.9.0
(function() {
  var app;

  app = angular.module('AECM', ['ngRoute', 'ngResource', 'ngProgress', 'ngAnimate']);

  app.base = "/assets/templates/";

  app.api = "/api/";

  app.config([
    '$routeProvider', '$locationProvider', function($routeProvider, $locationProvider) {
      $locationProvider.html5Mode(true);
      $routeProvider.when('/:from/:to', {
        templateUrl: app.base.concat('page.html'),
        controller: 'PageController'
      }).otherwise({
        redirectTo: '/startsida'
      });
    }
  ]);

  app.factory('Menu', [
    '$resource', function($resource) {
      return $resource(app.api.concat("menu.json"));
    }
  ]);

  app.factory('Page', [
    '$resource', function($resource) {
      return $resource(app.api.concat("page/:slug.json"));
    }
  ]);

  app.controller('HeaderController', [
    '$scope', '$window', function($scope, $window) {
      return $scope.site = $window.site;
    }
  ]);

  app.controller('NavigationController', [
    '$scope', '$location', 'Menu', function($scope, $location, Menu) {
      $scope.mobileNav = false;
      Menu.get({}, function(data) {
        return $scope.menu = data.menu;
      });
      $scope.isActive = function(route) {
        return route === $location.path();
      };
      $scope.toggleMobileNav = function() {
        return $scope.mobileNav = !$scope.mobileNav;
      };
      $scope.hideMobileNav = function() {
        return $scope.mobileNav = false;
      };
    }
  ]);

  app.controller('PageController', [
    '$scope', '$routeParams', '$sce', 'ngProgress', 'Page', '$window', function($scope, $routeParams, $sce, ngProgress, Page, $window) {
      ngProgress.height('4px');
      ngProgress.color($window.site.color);
      ngProgress.start();
      Page.get({
        slug: $routeParams.slug
      }, function(data) {
        var d, i, _i, _len, _ref;
        $scope.page = data.page[0];
        $scope.content = [];
        _ref = data.content;
        for (i = _i = 0, _len = _ref.length; _i < _len; i = ++_i) {
          d = _ref[i];
          $scope.content[i] = [];
          $scope.content[i]["content"] = $sce.trustAsHtml(data.content[i]["content"]);
          $scope.content[i]["image"] = data.content[i]["image"];
        }
        $scope.excerpt = $sce.trustAsHtml(data.page[0]["excerpt"]);
        return ngProgress.complete();
      }, function(error) {
        console.log(error);
        ngProgress.color('#d30000');
        ngProgress.set(99);
        $scope.page = {
          "id": 0,
          "title": "404"
        };
        return $scope.content = $sce.trustAsHtml("<h3>The requested page could not be found.</h3>");
      });
    }
  ]);

}).call(this);

//# sourceMappingURL=app.js.map
